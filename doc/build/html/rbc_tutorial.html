

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RBC Tutorial &mdash; dolo 0.4.9.5 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="dolo 0.4.9.5 documentation" href="index.html"/>
        <link rel="up" title="Examples" href="examples.html"/>
        <link rel="next" title="Frequently Asked Questions" href="faq.html"/>
        <link rel="prev" title="Sudden Stop Model" href="sudden_stop.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> dolo
          

          
          </a>

          
            
            
              <div class="version">
                0.4.9.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeling_language.html">The dolo language</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_api.html">Model API</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_specification.html">Dolo Model Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="algos.html">Solution algorithms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sudden_stop.html">Sudden Stop Model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">RBC Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solving-the-rbc-model">Solving the rbc model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decision-rule">Decision rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-the-model-to-simulate">Use the model to simulate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#impulse-response-functions">Impulse response functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#now-stochastic-simulations">Now Stochastic simulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#descriptive-statistics">Descriptive statistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#error-measures">Error measures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples.html#online-examples">Online examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous topics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">dolo</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="examples.html">Examples</a> &raquo;</li>
      
    <li>RBC Tutorial</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rbc-tutorial">
<h1>RBC Tutorial<a class="headerlink" href="#rbc-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="solving-the-rbc-model">
<h2>Solving the rbc model<a class="headerlink" href="#solving-the-rbc-model" title="Permalink to this headline">¶</a></h2>
<p>This worksheet demonstrates how to solve the RBC model with the
<a class="reference external" href="http://econforge.github.io/dolo/">dolo</a> library and how to generates
impulse responses and stochastic simulations from the solution.</p>
<ul class="simple">
<li>This notebook is distributed with dolo in : <code class="docutils literal"><span class="pre">examples\notebooks\</span></code>.
The notebook was opened and run from that directory.</li>
<li>The model file is in : <code class="docutils literal"><span class="pre">examples\global_models\</span></code></li>
</ul>
<p>First we import the dolo library.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">Populating</span> <span class="n">the</span> <span class="n">interactive</span> <span class="n">namespace</span> <span class="kn">from</span> <span class="nn">numpy</span> <span class="ow">and</span> <span class="n">matplotlib</span>
</pre></div>
</div>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dolo</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>The RBC model is defined in a
<a class="reference external" href="http://www.yaml.org/spec/1.2/spec.html#Introduction">YAML</a> file
which we can read locally or pull off the web.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/EconForge/dolo&#39;</span>
            <span class="s1">&#39;/master/examples/models/rbc.yaml&#39;</span><span class="p">)</span>

<span class="c1">#filename=&#39;../models/rbc.yaml&#39;</span>

<span class="n">pcat</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<style>
    .source .hll { background-color: #ffffcc }
.source  { background: #f8f8f8; }
.source .c { color: #408080; font-style: italic } /* Comment */
.source .err { border: 1px solid #FF0000 } /* Error */
.source .k { color: #008000; font-weight: bold } /* Keyword */
.source .o { color: #666666 } /* Operator */
.source .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.source .cp { color: #BC7A00 } /* Comment.Preproc */
.source .c1 { color: #408080; font-style: italic } /* Comment.Single */
.source .cs { color: #408080; font-style: italic } /* Comment.Special */
.source .gd { color: #A00000 } /* Generic.Deleted */
.source .ge { font-style: italic } /* Generic.Emph */
.source .gr { color: #FF0000 } /* Generic.Error */
.source .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.source .gi { color: #00A000 } /* Generic.Inserted */
.source .go { color: #888888 } /* Generic.Output */
.source .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.source .gs { font-weight: bold } /* Generic.Strong */
.source .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.source .gt { color: #0044DD } /* Generic.Traceback */
.source .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.source .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.source .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.source .kp { color: #008000 } /* Keyword.Pseudo */
.source .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.source .kt { color: #B00040 } /* Keyword.Type */
.source .m { color: #666666 } /* Literal.Number */
.source .s { color: #BA2121 } /* Literal.String */
.source .na { color: #7D9029 } /* Name.Attribute */
.source .nb { color: #008000 } /* Name.Builtin */
.source .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.source .no { color: #880000 } /* Name.Constant */
.source .nd { color: #AA22FF } /* Name.Decorator */
.source .ni { color: #999999; font-weight: bold } /* Name.Entity */
.source .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.source .nf { color: #0000FF } /* Name.Function */
.source .nl { color: #A0A000 } /* Name.Label */
.source .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.source .nt { color: #008000; font-weight: bold } /* Name.Tag */
.source .nv { color: #19177C } /* Name.Variable */
.source .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.source .w { color: #bbbbbb } /* Text.Whitespace */
.source .mb { color: #666666 } /* Literal.Number.Bin */
.source .mf { color: #666666 } /* Literal.Number.Float */
.source .mh { color: #666666 } /* Literal.Number.Hex */
.source .mi { color: #666666 } /* Literal.Number.Integer */
.source .mo { color: #666666 } /* Literal.Number.Oct */
.source .sb { color: #BA2121 } /* Literal.String.Backtick */
.source .sc { color: #BA2121 } /* Literal.String.Char */
.source .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.source .s2 { color: #BA2121 } /* Literal.String.Double */
.source .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.source .sh { color: #BA2121 } /* Literal.String.Heredoc */
.source .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.source .sx { color: #008000 } /* Literal.String.Other */
.source .sr { color: #BB6688 } /* Literal.String.Regex */
.source .s1 { color: #BA2121 } /* Literal.String.Single */
.source .ss { color: #19177C } /* Literal.String.Symbol */
.source .bp { color: #008000 } /* Name.Builtin.Pseudo */
.source .vc { color: #19177C } /* Name.Variable.Class */
.source .vg { color: #19177C } /* Name.Variable.Global */
.source .vi { color: #19177C } /* Name.Variable.Instance */
.source .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <table class="sourcetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72</pre></div></td><td class="code"><div class="source"><pre><span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">RBC</span>

<span class="l-Scalar-Plain">model_spec</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">fga</span>

<span class="l-Scalar-Plain">symbols</span><span class="p-Indicator">:</span>

   <span class="l-Scalar-Plain">states</span><span class="p-Indicator">:</span>  <span class="p-Indicator">[</span><span class="nv">z</span><span class="p-Indicator">,</span> <span class="nv">k</span><span class="p-Indicator">]</span>
   <span class="l-Scalar-Plain">controls</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">i</span><span class="p-Indicator">,</span> <span class="nv">n</span><span class="p-Indicator">]</span>
   <span class="l-Scalar-Plain">auxiliaries</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">c</span><span class="p-Indicator">,</span> <span class="nv">rk</span><span class="p-Indicator">,</span> <span class="nv">w</span><span class="p-Indicator">]</span>
   <span class="l-Scalar-Plain">values</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">V</span><span class="p-Indicator">]</span>
   <span class="l-Scalar-Plain">shocks</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">e_z</span><span class="p-Indicator">]</span>


   <span class="l-Scalar-Plain">parameters</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">beta</span><span class="p-Indicator">,</span> <span class="nv">sigma</span><span class="p-Indicator">,</span> <span class="nv">eta</span><span class="p-Indicator">,</span> <span class="nv">chi</span><span class="p-Indicator">,</span> <span class="nv">delta</span><span class="p-Indicator">,</span> <span class="nv">alpha</span><span class="p-Indicator">,</span> <span class="nv">rho</span><span class="p-Indicator">,</span> <span class="nv">zbar</span><span class="p-Indicator">,</span> <span class="nv">sig_z</span> <span class="p-Indicator">]</span>


<span class="l-Scalar-Plain">equations</span><span class="p-Indicator">:</span>


   <span class="l-Scalar-Plain">arbitrage</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">1 = beta*(c/c(1))^(sigma)*(1-delta+rk(1))   | 0 &lt;= i &lt;= inf</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">w - chi*n^eta*c^sigma                  | 0 &lt;= n &lt;= inf</span>

   <span class="l-Scalar-Plain">transition</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">z = (1-rho)*zbar + rho*z(-1) + e_z</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">k = (1-delta)*k(-1) + i(-1)</span>

   <span class="l-Scalar-Plain">auxiliary</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">c = z*k^alpha*n^(1-alpha) - i</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">rk = alpha*z*(n/k)^(1-alpha)</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">w = (1-alpha)*z*(k/n)^(alpha)</span>

   <span class="l-Scalar-Plain">value</span><span class="p-Indicator">:</span>
      <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">V = log(c) + beta*V(1)</span>

<span class="l-Scalar-Plain">calibration</span><span class="p-Indicator">:</span>


      <span class="l-Scalar-Plain">beta</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.99</span>
      <span class="l-Scalar-Plain">phi</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1</span>
      <span class="l-Scalar-Plain">chi</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">w/c^sigma/n^eta</span>
      <span class="l-Scalar-Plain">delta</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.025</span>
      <span class="l-Scalar-Plain">alpha</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.33</span>
      <span class="l-Scalar-Plain">rho</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.8</span>
      <span class="l-Scalar-Plain">sigma</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1</span>
      <span class="l-Scalar-Plain">eta</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1</span>
      <span class="l-Scalar-Plain">zbar</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1</span>
      <span class="l-Scalar-Plain">sig_z</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.016</span>


      <span class="l-Scalar-Plain">z</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">zbar</span>
      <span class="l-Scalar-Plain">rk</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">1/beta-1+delta</span>
      <span class="l-Scalar-Plain">w</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">(1-alpha)*z*(k/n)^(alpha)</span>
      <span class="l-Scalar-Plain">n</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.33</span>
      <span class="l-Scalar-Plain">k</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">n/(rk/alpha)^(1/(1-alpha))</span>
      <span class="l-Scalar-Plain">i</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">delta*k</span>
      <span class="l-Scalar-Plain">c</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">z*k^alpha*n^(1-alpha) - i</span>

      <span class="l-Scalar-Plain">V</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">log(c)/(1-beta)</span>


<span class="l-Scalar-Plain">covariances</span><span class="p-Indicator">:</span>

      <span class="p-Indicator">[</span> <span class="p-Indicator">[</span> <span class="nv">sig_z**2</span><span class="p-Indicator">]</span> <span class="p-Indicator">]</span>


<span class="l-Scalar-Plain">options</span><span class="p-Indicator">:</span>

    <span class="l-Scalar-Plain">approximation_space</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">a</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span> <span class="nv">1-2*sig_z</span><span class="p-Indicator">,</span> <span class="nv">k*0.9</span> <span class="p-Indicator">]</span>
        <span class="l-Scalar-Plain">b</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span> <span class="nv">1+2*sig_z</span><span class="p-Indicator">,</span> <span class="nv">k*1.1</span> <span class="p-Indicator">]</span>
        <span class="l-Scalar-Plain">orders</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">10</span><span class="p-Indicator">,</span> <span class="nv">50</span><span class="p-Indicator">]</span>
</pre></div>
</td></tr></table><p><code class="docutils literal"><span class="pre">yaml_import(filename)</span></code> reads the YAML file and generates a model
object.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">yaml_import</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>The model file already has values for steady-state variables stated in
the calibration section so we can go ahead and check that they are
correct by computing the model equations at the steady state.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">residuals</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;transition&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span>  <span class="mf">0.00000000e+00</span><span class="p">,</span>   <span class="mf">2.50466314e-13</span><span class="p">])),</span> <span class="p">(</span><span class="s1">&#39;arbitrage&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">1.01030295e-14</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.78141962e-12</span><span class="p">])),</span> <span class="p">(</span><span class="s1">&#39;auxiliary&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span> <span class="o">-</span><span class="mf">3.28626015e-13</span><span class="p">,</span>   <span class="mf">7.63278329e-17</span><span class="p">,</span>   <span class="mf">4.48352466e-12</span><span class="p">])),</span> <span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span>  <span class="mf">7.81597009e-14</span><span class="p">]))])</span>
</pre></div>
</div>
<p>Printing the model also lets us have a look at all the model equations
and check that all residual errors are 0 at the steady-state, but with
less display prescision.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">model</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">Model</span> <span class="nb">object</span><span class="p">:</span>
<span class="o">------------</span>

<span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;RBC&quot;</span>
<span class="o">-</span> <span class="nb">type</span><span class="p">:</span> <span class="s2">&quot;fga&quot;</span>
<span class="o">-</span> <span class="n">file</span><span class="p">:</span> <span class="s2">&quot;https://raw.githubusercontent.com/EconForge/dolo/master/examples/models/rbc.yaml</span>

<span class="o">-</span> <span class="n">residuals</span><span class="p">:</span>

    <span class="n">transition</span>
        <span class="mi">1</span>   <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rho</span><span class="p">)</span><span class="o">*</span><span class="n">zbar</span> <span class="o">+</span> <span class="n">rho</span><span class="o">*</span><span class="n">z</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">e_z</span>
        <span class="mi">2</span>   <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span> <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">delta</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">arbitrage</span>
        <span class="mi">1</span>   <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">delta</span><span class="o">+</span><span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>   <span class="o">|</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">inf</span>
        <span class="mi">2</span>   <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span> <span class="n">w</span> <span class="o">-</span> <span class="n">chi</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="n">eta</span><span class="o">*</span><span class="n">c</span><span class="o">**</span><span class="n">sigma</span>                  <span class="o">|</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="n">inf</span>

    <span class="n">auxiliary</span>
        <span class="mi">1</span>   <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span> <span class="n">c</span> <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="n">k</span><span class="o">**</span><span class="n">alpha</span><span class="o">*</span><span class="n">n</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span>
        <span class="mi">2</span>   <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span> <span class="n">rk</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">k</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span>
        <span class="mi">3</span>   <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span> <span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

    <span class="n">value</span>
        <span class="mi">1</span>   <span class="p">:</span> <span class="mf">0.0000</span> <span class="p">:</span> <span class="n">V</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we compute a solution to the model using a second order
perturbation method (see the source for the
<a class="reference external" href="https://github.com/EconForge/dolo/blob/master/dolo/algos/fg/perturbations.py">approximate_controls</a>
function). The result is a decsion rule object. By decision rule we
refer to any object is callable and maps states to decisions. This
particular decision rule object is a TaylorExpansion (see the source for
the
<a class="reference external" href="https://github.com/EconForge/dolo/blob/master/dolo/numeric/taylor_expansion.py">TaylorExpansion</a>
class).</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">dr_pert</span> <span class="o">=</span> <span class="n">approximate_controls</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">There</span> <span class="n">are</span> <span class="mi">2</span> <span class="n">eigenvalues</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">1.</span> <span class="n">Expected</span><span class="p">:</span> <span class="mf">2.</span>
</pre></div>
</div>
<p>We now compute the global solution (see the source for the
<a class="reference external" href="https://github.com/EconForge/dolo/blob/master/dolo/algos/fg/time_iteration.py">time_iteration</a>
function). It returns a decision rule object of type SmolyakGrid (see
the source for the
<a class="reference external" href="https://github.com/EconForge/dolo/blob/master/dolo/numeric/interpolation/smolyak.py">SmolyakGrid</a>
class).</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">dr_global</span> <span class="o">=</span> <span class="n">time_iteration</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">pert_order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">smolyak_order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="decision-rule">
<h2>Decision rule<a class="headerlink" href="#decision-rule" title="Permalink to this headline">¶</a></h2>
<p>Here we plot optimal investment and labour for different levels of
capital (see the source for the
<a class="reference external" href="https://github.com/EconForge/dolo/blob/master/dolo/algos/fg/simulations.py">plot_decision_rule</a>
function).</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">Decisionbounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">dr_global</span><span class="o">.</span><span class="n">smin</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dr_global</span><span class="o">.</span><span class="n">smax</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">figsize</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">3.5</span><span class="p">)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plot_decision_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr_global</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Global&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">plot_decision_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr_pert</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Perturbation&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Investment&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plot_decision_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr_global</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Global&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">plot_decision_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr_pert</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Perturbation&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Labour&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>

<span class="n">tight_layout</span><span class="p">()</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/quick_tutorial_17_0.png" src="_images/quick_tutorial_17_0.png" />
<p>It would seem, according to this, that second order perturbation does
very well for the RBC model. We will revisit this issue more rigorously
when we explore the deviations from the model&#8217;s arbitrage section
equations.</p>
<p>Let us repeat the calculation of investment decisions for various values
of the depreciation rate, <span class="math">\(\delta\)</span>. Note that this is a
comparative statics exercise, even though the models compared are
dynamic.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">original_delta</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">calibration_dict</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span>

<span class="n">drs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">delta_values</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">delta_values</span><span class="p">:</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_calibration</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
    <span class="n">drs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">approximate_controls</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>


<span class="n">figsize</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">dr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">drs</span><span class="p">):</span>
    <span class="n">plot_decision_rule</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span>
                       <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\delta=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">delta_values</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                       <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>

<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Investment&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">set_calibration</span><span class="p">(</span><span class="n">delta</span><span class="o">=</span><span class="n">original_delta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">There</span> <span class="n">are</span> <span class="mi">2</span> <span class="n">eigenvalues</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">1.</span> <span class="n">Expected</span><span class="p">:</span> <span class="mf">2.</span>
<span class="n">There</span> <span class="n">are</span> <span class="mi">2</span> <span class="n">eigenvalues</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">1.</span> <span class="n">Expected</span><span class="p">:</span> <span class="mf">2.</span>
<span class="n">There</span> <span class="n">are</span> <span class="mi">2</span> <span class="n">eigenvalues</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">1.</span> <span class="n">Expected</span><span class="p">:</span> <span class="mf">2.</span>
<span class="n">There</span> <span class="n">are</span> <span class="mi">2</span> <span class="n">eigenvalues</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">1.</span> <span class="n">Expected</span><span class="p">:</span> <span class="mf">2.</span>
<span class="n">There</span> <span class="n">are</span> <span class="mi">2</span> <span class="n">eigenvalues</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">1.</span> <span class="n">Expected</span><span class="p">:</span> <span class="mf">2.</span>
</pre></div>
</div>
<img alt="_images/quick_tutorial_19_1.png" src="_images/quick_tutorial_19_1.png" />
<p>We find that more durable capital leads to higher steady state
investment and slows the rate of convergence for capital (the slopes are
roughly the same, which implies that relative to steady state capital
investment responds stronger at higher <span class="math">\(\delta\)</span>, this in addition
to the direct effect of depreciation).</p>
</div>
<div class="section" id="use-the-model-to-simulate">
<h2>Use the model to simulate<a class="headerlink" href="#use-the-model-to-simulate" title="Permalink to this headline">¶</a></h2>
<p>We will use the deterministic steady-state as a starting point.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">s0</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">calibration</span><span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">s0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span> <span class="mf">1.</span>          <span class="mf">9.35497829</span><span class="p">]</span>
</pre></div>
</div>
<p>We also get the covariance matrix just in case. This is a one shock
model so all we have it the variance of <span class="math">\(e_z\)</span>.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">distrib</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
<span class="n">sigma2_ez</span> <span class="o">=</span> <span class="n">distrib</span><span class="o">.</span><span class="n">sigma</span>
<span class="n">sigma2_ez</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.000256</span><span class="p">]])</span>
</pre></div>
</div>
<div class="section" id="impulse-response-functions">
<h3>Impulse response functions<a class="headerlink" href="#impulse-response-functions" title="Permalink to this headline">¶</a></h3>
<p>Consider a 10% shock on productivity.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">s0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">s1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.1</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span> <span class="mf">1.1</span>         <span class="mf">9.35497829</span><span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">simulate</span></code> function is used both to trace impulse response
functions and compute stochastic simulations. Choosing <code class="docutils literal"><span class="pre">n_exp&gt;=1</span></code>,
will result in that many &#8220;stochastic&#8221; simulations. With <code class="docutils literal"><span class="pre">n_exp</span> <span class="pre">=</span> <span class="pre">0</span></code>,
we get one single simulation without any stochastic shock (see the
source for the
<a class="reference external" href="https://github.com/EconForge/dolo/blob/master/dolo/algos/fg/simulations.py">simulate</a>
function). The output is a panda table of size <span class="math">\(H \times n_v\)</span>
where <span class="math">\(n_v\)</span> is the number of variables in the model and <span class="math">\(H\)</span>
the number of dates.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">irf</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr_global</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">n_exp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">40</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">irf</span><span class="o">.</span><span class="n">__class__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">irf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
(40, 7)
</pre></div>
</div>
<p>Let us plot the response of consumption and investment.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">figsize</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">irf</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Productivity&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">irf</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Investment&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">irf</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Labour&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">irf</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consumption&#39;</span><span class="p">)</span>

<span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/quick_tutorial_31_0.png" src="_images/quick_tutorial_31_0.png" />
<p>Note that the plotting is made using the wonderful
<a class="reference external" href="http://matplotlib.org/users/pyplot_tutorial.html">matplotlib</a>
library. Read the online
<a class="reference external" href="http://matplotlib.org/users/beginner.html">tutorials</a> to learn how
to customize the plots to your needs (e.g., using
<a class="reference external" href="http://matplotlib.org/users/usetex.html">latex</a> in annotations). If
instead you would like to produce charts in Matlab, you can easily
export the impulse response functions, or any other matrix, to a
<code class="docutils literal"><span class="pre">.mat</span></code> file.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">irf_array</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span> <span class="n">irf</span> <span class="p">)</span>
<span class="kn">import</span> <span class="nn">scipy.io</span>
<span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="s2">&quot;export.mat&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;table&#39;</span><span class="p">:</span> <span class="n">irf_array</span><span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="now-stochastic-simulations">
<h3>Now Stochastic simulations<a class="headerlink" href="#now-stochastic-simulations" title="Permalink to this headline">¶</a></h3>
<p>Now we run 1000 random simulations the result is an array of size
<span class="math">\(H\times n_{exp} \times n_v\)</span> where - <span class="math">\(H\)</span> the number of dates
- <span class="math">\(n_{exp}\)</span> the number of simulations - <span class="math">\(n_v\)</span> is the number
of variables</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr_global</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">n_exp</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">40</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">variables</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;rk&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We plot the responses of consumption, investment and labour to the
stochastic path of productivity.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">i_z</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">i_i</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="n">i_n</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="n">i_c</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">figsize</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_z</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_n</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">sim</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_c</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Productivity&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Investment&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Labour&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Consumption&#39;</span><span class="p">)</span>

<span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/quick_tutorial_38_0.png" src="_images/quick_tutorial_38_0.png" />
<p>We find that while the distribution of investment and labour converges
quickly to the ergodic distribution, that of consumption takes
noticeably longer. This is indicative of higher persistence in
consumption, which in turn could be explained by permanent income
considerations.</p>
</div>
<div class="section" id="descriptive-statistics">
<h3>Descriptive statistics<a class="headerlink" href="#descriptive-statistics" title="Permalink to this headline">¶</a></h3>
<p>The success of the RBC model is in being able to mimic patterns in the
descriptive statistics of the real economy. Let us compute some of these
descriptive statistics from our sample of stochastic simulations. First
we compute growth rates:</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">dsim</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">sim</span><span class="p">[</span><span class="mi">1</span><span class="p">:,:,:]</span><span class="o">/</span><span class="n">sim</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,:,])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dsim</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we compute the volatility of growth rates for each simulation:</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">volat</span> <span class="o">=</span> <span class="n">dsim</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">volat</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we compute the mean and a confidence interval for each variable. In
the generated table the first column contains the standard deviations of
growth rates. The second and third columns contain the lower and upper
bounds of the 95% confidence intervals, respectively.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">column_stack</span><span class="p">([</span>
    <span class="n">volat</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">volat</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="mf">1.96</span><span class="o">*</span><span class="n">volat</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="n">volat</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mf">1.96</span><span class="o">*</span><span class="n">volat</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="p">])</span>
<span class="n">table</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.01667413</span><span class="p">,</span>  <span class="mf">0.01280193</span><span class="p">,</span>  <span class="mf">0.02054634</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.00296542</span><span class="p">,</span>  <span class="mf">0.00175695</span><span class="p">,</span>  <span class="mf">0.00417388</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.09196494</span><span class="p">,</span>  <span class="mf">0.06834055</span><span class="p">,</span>  <span class="mf">0.11558933</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.01028367</span><span class="p">,</span>  <span class="mf">0.00788583</span><span class="p">,</span>  <span class="mf">0.01268152</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.00313835</span><span class="p">,</span>  <span class="mf">0.00236476</span><span class="p">,</span>  <span class="mf">0.00391193</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.02426923</span><span class="p">,</span>  <span class="mf">0.01861151</span><span class="p">,</span>  <span class="mf">0.02992694</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.01303212</span><span class="p">,</span>  <span class="mf">0.01002955</span><span class="p">,</span>  <span class="mf">0.01603469</span><span class="p">]])</span>
</pre></div>
</div>
<p>We can use the
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/10min.html">pandas</a>
library to present the results in a nice table.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">variables</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;rk&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span>
                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Growth rate std.&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Lower 95% bound&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Upper 95% bound&#39;</span> <span class="p">])</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Growth rate std.</th>
      <th>Lower 95% bound</th>
      <th>Upper 95% bound</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>z</th>
      <td> 0.017</td>
      <td> 0.013</td>
      <td> 0.021</td>
    </tr>
    <tr>
      <th>k</th>
      <td> 0.003</td>
      <td> 0.002</td>
      <td> 0.004</td>
    </tr>
    <tr>
      <th>i</th>
      <td> 0.092</td>
      <td> 0.068</td>
      <td> 0.116</td>
    </tr>
    <tr>
      <th>n</th>
      <td> 0.010</td>
      <td> 0.008</td>
      <td> 0.013</td>
    </tr>
    <tr>
      <th>c</th>
      <td> 0.003</td>
      <td> 0.002</td>
      <td> 0.004</td>
    </tr>
    <tr>
      <th>rk</th>
      <td> 0.024</td>
      <td> 0.019</td>
      <td> 0.030</td>
    </tr>
    <tr>
      <th>w</th>
      <td> 0.013</td>
      <td> 0.010</td>
      <td> 0.016</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="error-measures">
<h2>Error measures<a class="headerlink" href="#error-measures" title="Permalink to this headline">¶</a></h2>
<p>It is always important to get a handle on the accuracy of the solution.
The <code class="docutils literal"><span class="pre">omega</span></code> function computes and aggregates the errors for the
model&#8217;s arbitrage section equations. For the RBC model these are the
investment demand and labor supply equations. For each equation it
reports the maximum error over the domain and the mean error using
ergodic distribution weights (see the source for the
<a class="reference external" href="https://github.com/EconForge/dolo/blob/master/dolo/algos/fg/accuracy.py">omega</a>
function).</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">ErrorErrorfrom</span> <span class="n">dolo</span><span class="o">.</span><span class="n">algos</span><span class="o">.</span><span class="n">dtcscc</span><span class="o">.</span><span class="n">accuracy</span> <span class="kn">import</span> <span class="nn">omega</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Perturbation solution&quot;</span><span class="p">)</span>
<span class="n">err_pert</span> <span class="o">=</span> <span class="n">omega</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr_pert</span><span class="p">)</span>
<span class="n">err_pert</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">Perturbation</span> <span class="n">solution</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">Euler</span> <span class="n">Errors</span><span class="p">:</span>
<span class="o">-</span> <span class="n">max_errors</span>     <span class="p">:</span> <span class="p">[</span> <span class="mf">0.00019241</span>  <span class="mf">0.00045583</span><span class="p">]</span>
<span class="o">-</span> <span class="n">ergodic</span>        <span class="p">:</span> <span class="p">[</span>  <span class="mf">1.37473238e-04</span>   <span class="mf">1.69920101e-05</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Global solution&quot;</span><span class="p">)</span>
<span class="n">err_global</span><span class="o">=</span><span class="n">omega</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dr_global</span><span class="p">)</span>
<span class="n">err_global</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">Global</span> <span class="n">solution</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">Euler</span> <span class="n">Errors</span><span class="p">:</span>
<span class="o">-</span> <span class="n">max_errors</span>     <span class="p">:</span> <span class="p">[</span>  <span class="mf">1.38008607e-04</span>   <span class="mf">2.28991817e-06</span><span class="p">]</span>
<span class="o">-</span> <span class="n">ergodic</span>        <span class="p">:</span> <span class="p">[</span>  <span class="mf">1.32367122e-04</span>   <span class="mf">6.62075500e-07</span><span class="p">]</span>
</pre></div>
</div>
<p>The result of <code class="docutils literal"><span class="pre">omega</span></code> is a subclass of <code class="docutils literal"><span class="pre">dict</span></code>. <code class="docutils literal"><span class="pre">omega</span></code> fills that
dict with some useful information that the default print does not
reveal:</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">err_pert</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">,</span> <span class="s1">&#39;densities&#39;</span><span class="p">,</span> <span class="s1">&#39;ergodic&#39;</span><span class="p">,</span> <span class="s1">&#39;max_errors&#39;</span><span class="p">,</span> <span class="s1">&#39;bounds&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>In particular the domain field contains information, like bounds and
shape, that we can use to plot the spatial pattern of errors.</p>
<div class="code python highlight-python3"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">err_pert</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">a</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">err_pert</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">b</span>
<span class="n">orders</span> <span class="o">=</span> <span class="n">err_pert</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">orders</span>
<span class="n">errors</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">((</span><span class="n">err_pert</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span> <span class="n">orders</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">),</span>
                      <span class="n">err_global</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span> <span class="n">orders</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)),</span>
                     <span class="mi">2</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Investment demand pertubation errors&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Labor supply pertubation errors&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Investment demand global errors&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Labor supply global errors&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>

    <span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">imgplot</span> <span class="o">=</span> <span class="n">imshow</span><span class="p">(</span><span class="n">errors</span><span class="p">[:,:,</span><span class="n">i</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                     <span class="n">extent</span><span class="o">=</span><span class="p">(</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">imgplot</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">colorbar</span><span class="p">()</span>
    <span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
    <span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/quick_tutorial_55_0.png" src="_images/quick_tutorial_55_0.png" />
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="faq.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sudden_stop.html" class="btn btn-neutral" title="Sudden Stop Model" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2016, Pablo Winant.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.4.9.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>