
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Custom model types &mdash; dolo 0.4.4 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css"
type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css"
type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.4.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="dolo 0.4.4 documentation" href="index.html" />
    <link rel="up" title="Advanced topics" href="api.html" />
    <link rel="next" title="Structure of dolo" href="structure.html" />
    <link rel="prev" title="Advanced topics" href="api.html" /> 
<link href="http://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  </head>
  <body>



<!-- Piwik -->
<script type="text/javascript">
if ("matplotlib.sourceforge.net" == document.location.hostname ||
    "matplotlib.sf.net" == document.location.hostname) {
  var pkBaseURL = (("https:" == document.location.protocol) ? "https://apps.sourceforge.net/piwik/matplotlib/" : "http://apps.sourceforge.net/piwik/matplotlib/");
  document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
}
</script>
<script type="text/javascript">
if ("matplotlib.sourceforge.net" == document.location.hostname ||
    "matplotlib.sf.net" == document.location.hostname) {
  piwik_action_name = '';
  piwik_idsite = 1;
  piwik_url = pkBaseURL + "piwik.php";
  piwik_log(piwik_action_name, piwik_idsite, piwik_url);
  document.write(unescape('%3Cobject%3E%3Cnoscript%3E%3Cp%3E%3Cimg src="http://apps.sourceforge.net/piwik/matplotlib/piwik.php?idsite=1" alt="piwik"/%3E%3C/p%3E%3C/noscript%3E%3C/object%3E'));
}
</script>
<!-- End Piwik Tag -->
<link rel="shortcut icon" href="_static/favicon.ico">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo2.png" border="0" alt="matplotlib"/></a>
</div>




    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="structure.html" title="Structure of dolo"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="api.html" title="Advanced topics"
             accesskey="P">previous</a> |</li>

        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="examples.html">examples</a>|&nbsp;</li>
        <li><a href="installation.html">install</a>&raquo;</li>
          <li><a href="api.html" accesskey="U">Advanced topics</a> &raquo;</li> 
      </ul>
    </div>

  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Quick tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Solution algorithms</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">Advanced topics</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Custom model types</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure.html">Structure of dolo</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html">Model object</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpolation.html">Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="compilation.html">Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html">Model conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="perturbations.html">Perturbation algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="routines.html">Solution routines</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="custom-model-types">
<h1>Custom model types<a class="headerlink" href="#custom-model-types" title="Permalink to this headline">¶</a></h1>
<div class="section" id="recipes">
<h2>Recipes<a class="headerlink" href="#recipes" title="Permalink to this headline">¶</a></h2>
<p>Different kinds of solution algorithm are associated with several
ways of writing the model.
Dolo provides a simple way to define your own type of models. These models
can then be translated into numerical models.</p>
<p>A custom definition of a model type is called a recipe. Recipes can be
described in a YAML file or directly as a Python object. Let&#8217;s inspect the
file which define the <tt class="docutils literal"><span class="pre">fga</span></tt> type is used by the default time-iteration
algorithm.</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span class="l-Scalar-Plain">model_type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">fga</span>

<span class="l-Scalar-Plain">symbol_type</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="s">&#39;states&#39;</span><span class="p-Indicator">,</span> <span class="s">&#39;controls&#39;</span><span class="p-Indicator">,</span> <span class="s">&#39;auxiliary&#39;</span><span class="p-Indicator">]</span>

<span class="l-Scalar-Plain">equation_type</span><span class="p-Indicator">:</span>

    <span class="l-Scalar-Plain">arbitrage</span><span class="p-Indicator">:</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;states&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;controls&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;auxiliary&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;states&#39;</span><span class="p-Indicator">,</span><span class="nv">1</span><span class="p-Indicator">]</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;controls&#39;</span><span class="p-Indicator">,</span><span class="nv">1</span><span class="p-Indicator">]</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;auxiliary&#39;</span><span class="p-Indicator">,</span><span class="nv">1</span><span class="p-Indicator">]</span>

    <span class="l-Scalar-Plain">transition</span><span class="p-Indicator">:</span>

        <span class="l-Scalar-Plain">definition</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>

        <span class="l-Scalar-Plain">lhs</span><span class="p-Indicator">:</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;states&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>

        <span class="l-Scalar-Plain">rhs</span><span class="p-Indicator">:</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;states&#39;</span><span class="p-Indicator">,</span><span class="nv">-1</span><span class="p-Indicator">]</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;controls&#39;</span><span class="p-Indicator">,</span><span class="nv">-1</span><span class="p-Indicator">]</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;auxiliary&#39;</span><span class="p-Indicator">,</span><span class="nv">-1</span><span class="p-Indicator">]</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;shocks&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>

    <span class="l-Scalar-Plain">auxiliary</span><span class="p-Indicator">:</span>

        <span class="l-Scalar-Plain">definition</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">True</span>

        <span class="l-Scalar-Plain">lhs</span><span class="p-Indicator">:</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;auxiliary&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>

        <span class="l-Scalar-Plain">rhs</span><span class="p-Indicator">:</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;states&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;controls&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>
            <span class="p-Indicator">-</span> <span class="p-Indicator">[</span><span class="s">&#39;shocks&#39;</span><span class="p-Indicator">,</span><span class="nv">0</span><span class="p-Indicator">]</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>First the <tt class="docutils literal"><span class="pre">model_type</span></tt> key defines a short name for the recipe.</li>
<li>Second, a list of symbol types is declared. Two types of symbols are automatically</li>
</ul>
<p>added to that list : <tt class="docutils literal"><span class="pre">shocks</span></tt> and <tt class="docutils literal"><span class="pre">parameters</span></tt>.</p>
<ul>
<li><p class="first">Third, all blocks of equation are described in the equation_type part
by supplying a list of allowed symbol types, with the date at which they occur.</p>
<p>Currently, two types of blocks are recognized by dolo:</p>
<blockquote>
<div><ul class="simple">
<li>regular blocks (like <tt class="docutils literal"><span class="pre">arbitrage</span></tt>) consist of a list of expressions. When an equal
sign is supplied in the model file, the right hand side is substracted from the left hand side.</li>
<li>definition blocks (with <tt class="docutils literal"><span class="pre">definition:</span> <span class="pre">True</span></tt> as in <tt class="docutils literal"><span class="pre">transition</span></tt> and <tt class="docutils literal"><span class="pre">auxiliary</span></tt>) define the left hand
side as a function of the right hand side. The left hand side must be a series of variable
at date 0.</li>
</ul>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">When an actual model is checked, dolo will check that these variables are defined
in the same order as in the declaration header of the model file. It also allows for recursive definitions as long
as the block of equations forms a triangular system of the left hand side variables.</p>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="checking-a-model-s-validity">
<h2>Checking a model&#8217;s validity<a class="headerlink" href="#checking-a-model-s-validity" title="Permalink to this headline">¶</a></h2>
<p>A recipe can be used inside Python to check the validity of a symbolic model.
For instance the following code checks that the <tt class="docutils literal"><span class="pre">rbc.yaml</span></tt> file is valid.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">model</span> <span class="o">=</span> <span class="n">yaml_import</span><span class="p">(</span><span class="s">&#39;rbc.yaml&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">dolo.symbolic.recipes</span> <span class="kn">import</span> <span class="n">recipe_fga</span>
<span class="kn">from</span> <span class="nn">dolo.symbolic.validator</span> <span class="kn">import</span> <span class="n">validate</span>

<span class="n">validate</span><span class="p">(</span> <span class="n">model</span><span class="p">,</span> <span class="n">recipe_fga</span> <span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>If the model is valid according the its definition, the last function will not do anything. If not an error is thrown.</p>
</div>
<div class="section" id="producing-matlab-julia-code-using-a-custom-recipe">
<h2>Producing matlab/julia code using a custom recipe<a class="headerlink" href="#producing-matlab-julia-code-using-a-custom-recipe" title="Permalink to this headline">¶</a></h2>
<p>Assuming a model and a recipe are respectively defined in files <tt class="docutils literal"><span class="pre">model.yaml</span></tt> and <tt class="docutils literal"><span class="pre">recipe.yaml</span></tt>, one can generate
a compiled model for matlab <tt class="docutils literal"><span class="pre">model.m</span></tt> using the following command:</p>
<div class="highlight-sh"><div class="highlight"><pre>dolo-matlab model.yaml --recipe<span class="o">=</span>recipe.yaml
</pre></div>
</div>
<p>The same can be down for Julia using:</p>
<div class="highlight-sh"><div class="highlight"><pre>dolo-matlab model.yaml --recipe<span class="o">=</span>recipe.yaml
</pre></div>
</div>
<p>The resulting file will contain nested structures (or nested dictionaries depending on the target language) with
the following content:</p>
<div class="highlight-python"><pre>- symbols

    - val_1         ( cell array with names of symbols of type 1 )
    - val_2
    - parameters    ( names of parameters )
    - shocks        ( names of shocks )

- calibration

    - steady_state
            - val_1     ( steady_state values for symbols of type 1 )
            - val_2
    - parameters        ( numeric values for parameters )
    - sigma             ( covariance matrix )

- functions

    - fun1    ( function of type fun1 )
    - fun2</pre>
</div>
<p>The generated function handlers (here <tt class="docutils literal"><span class="pre">fun1</span></tt> and <tt class="docutils literal"><span class="pre">fun2</span></tt>) have the following signature : <tt class="docutils literal"><span class="pre">fun(arg1,</span> <span class="pre">arg2,</span> <span class="pre">...,</span> <span class="pre">p)</span></tt>
where <tt class="docutils literal"><span class="pre">arg_i</span></tt> is the i-th argument defined in the recipe as <tt class="docutils literal"><span class="pre">type_i</span></tt>, and is expected to be a vertical array of size <tt class="docutils literal"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">n_i</span></tt>
where <tt class="docutils literal"><span class="pre">n_i</span></tt> is the number of variables of type <tt class="docutils literal"><span class="pre">type_i</span></tt> and <tt class="docutils literal"><span class="pre">N</span></tt> is the number of points at which the function
must be evaluated. <tt class="docutils literal"><span class="pre">p</span></tt> is a one dimensional vector of parameter values.</p>
<blockquote>
<div><div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">For row-major languages, especially for Python, arrays are expected to be of the size <tt class="docutils literal"><span class="pre">n_i</span> <span class="pre">x</span> <span class="pre">N</span></tt> so that
the function can still operate on contiguous chunks of memory when <tt class="docutils literal"><span class="pre">N</span></tt> is big.</p>
</div>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Pablo Winant.
      Created using <a
href="http://sphinx-doc.org/">Sphinx</a> 1.1.3.
    </div>

</body>
</html>